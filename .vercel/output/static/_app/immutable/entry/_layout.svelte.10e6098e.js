import{S as P,i as $,s as S,C as k,a as A,k as C,D as L,h as f,c as v,l as U,m as N,n as g,b,E as w,F as D,G as T,g as y,d as G,H as M,o as O}from"../chunks/index.485fcb8d.js";import{g as _}from"../chunks/navigation.eb682a3d.js";import{r as B,u as p,C as j}from"../chunks/index.e036d59b.js";import{p as q}from"../chunks/stores.68838911.js";import{P as E,a as z,s as d,d as I}from"../chunks/db.a3b95309.js";import{m}from"../chunks/mixpanel.cjs.2e5b2863.js";import{_ as F}from"../chunks/preload-helper.41c905a7.js";const H=B("App",{web:()=>F(()=>import("../chunks/web.f978dcbb.js"),["../chunks/web.f978dcbb.js","../chunks/index.e036d59b.js","../chunks/index.1e0a1e55.js","../chunks/index.485fcb8d.js"],import.meta.url).then(o=>new o.AppWeb)});function K(o){let n,l,a,r,i;document.title=n=E;const u=o[2].default,e=k(u,o,o[1],null);return{c(){l=A(),a=C("main"),e&&e.c(),this.h()},l(s){L("svelte-mg3ozw",document.head).forEach(f),l=v(s),a=U(s,"MAIN",{class:!0});var c=N(a);e&&e.l(c),c.forEach(f),this.h()},h(){g(a,"class",r=`bg-background ${o[0]?"pt-20":"pt-10"}`)},m(s,t){b(s,l,t),b(s,a,t),e&&e.m(a,null),i=!0},p(s,[t]){(!i||t&0)&&n!==(n=E)&&(document.title=n),e&&e.p&&(!i||t&2)&&w(e,u,s,s[1],i?T(u,s[1],t,null):D(s[1]),null),(!i||t&1&&r!==(r=`bg-background ${s[0]?"pt-20":"pt-10"}`))&&g(a,"class",r)},i(s){i||(y(e,s),i=!0)},o(s){G(e,s),i=!1},d(s){s&&f(l),s&&f(a),e&&e.d(s)}}}function R(o,n,l){let a;M(o,q,e=>l(4,a=e));let{$$slots:r={},$$scope:i}=n;m.init(z),p.subscribe(e=>{}),O(()=>{d.auth.getSession().then(({data:e})=>{var s;(s=e.session)!=null&&s.user?(p.set(e.session.user),m.identify(e.session.user.id),m.people.set({$email:e.session.user.email}),I.billing.getUserPlan()):a.url.pathname.includes("/sign")||_("/signin")}),d.auth.onAuthStateChange((e,s)=>{e=="SIGNED_IN"&&(s!=null&&s.user)?(console.log("ok ok"),p.set(s.user),_("/")):e=="SIGNED_OUT"&&(p.set(null),_("/signin"))}),H.addListener("appUrlOpen",async function(e){var h;const s=e.url.split("&refresh_token")[1].split("&")[0].split("=")[1],{data:t,error:c}=await d.auth.refreshSession({refresh_token:s});(h=t.session)!=null&&h.user&&(p.set(t.session.user),m.identify(t.session.user.id),m.people.set({$email:t.session.user.email}),I.billing.getUserPlan(),_("/"))})});let u=!1;return j.getPlatform()==="ios"&&(u=!0),o.$$set=e=>{"$$scope"in e&&l(1,i=e.$$scope)},[u,i,r]}class x extends P{constructor(n){super(),$(this,n,R,K,S,{})}}export{x as default};
